(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9052],{91001:function(e,t,i){(window.__NEXT_P=window.__NEXT_P||[]).push(["/purchase-payment",function(){return i(69531)}])},92832:function(e,t,i){"use strict";var l=i(85893),n=i(67294),r=i(69417),s=i(50657),a=i(90948),o=i(15861),d=i(16628),u=i(6514),c=i(31425),m=i(93946);i(63850);var p=i(79878);let h=(0,a.ZP)(m.Z)(e=>{let{theme:t}=e;return{top:0,right:0,color:"grey.500",position:"absolute",boxShadow:t.shadows[2],transform:"translate(10px, -10px)",borderRadius:t.shape.borderRadius,backgroundColor:"".concat(t.palette.background.paper," !important"),transition:"transform 0.25s ease-in-out, box-shadow 0.25s ease-in-out","&:hover":{transform:"translate(7px, -5px)"}}}),v=(0,n.forwardRef)(function(e,t){return(0,l.jsx)(d.Z,{ref:t,...e})}),x=e=>{let{show:t=!1,setShow:i,title:n="Title",description:a="本当によろしいでしょうか？",onClickSubmit:d,onClickClose:m,showButton:x=!0}=e,f=()=>{i(!1),m&&m()},Z=()=>{d&&d()};return(0,l.jsxs)(s.Z,{fullWidth:!0,open:t,maxWidth:"sm",scroll:"body",onClose:f,TransitionComponent:v,sx:{"& .MuiDialog-paper":{overflow:"visible"}},children:[(0,l.jsxs)(u.Z,{children:[(0,l.jsx)(h,{onClick:f,children:(0,l.jsx)(p.Z,{icon:"tabler:x",fontSize:"1.25rem"})}),(0,l.jsx)(o.Z,{variant:"h6",children:n}),(0,l.jsx)(o.Z,{sx:{marginTop:"24px"},children:a})]}),x&&(0,l.jsxs)(c.Z,{children:[(0,l.jsx)(r.Z,{variant:"tonal",color:"secondary",onClick:f,children:"キャンセル"}),(0,l.jsx)(r.Z,{variant:"contained",sx:{mr:1},onClick:Z,children:"送信"})]})]})};t.Z=x},53198:function(e,t,i){"use strict";var l=i(85893),n=i(53816),r=i(53252),s=i(18979);i(67294);let a=e=>{let{rowsNum:t,cellsNum:i}=e;return[...Array(t)].map((e,t)=>(0,l.jsx)(n.Z,{children:[...Array(i)].map((e,t)=>(0,l.jsx)(r.Z,{children:(0,l.jsx)(s.Z,{animation:"wave",variant:"text"})},t))},t))};t.Z=a},74368:function(e,t,i){"use strict";i.d(t,{$U:function(){return v},Bi:function(){return d},Iy:function(){return a},Kd:function(){return h},U2:function(){return u},WL:function(){return o},Wd:function(){return s},cB:function(){return p},ec:function(){return x},hN:function(){return f},sl:function(){return r},y_:function(){return c}});var l=i(27484),n=i.n(l);let r=["PUBLIC","PRIVATE","DELETED"],s={PUBLIC:"公開",PRIVATE:"非公開",DELETED:"削除"},a={END_FOLLOWING_MONTH:"30日(月末)",DATE_10_FOLLOWING_MONTH:"10日",DATE_15_FOLLOWING_MONTH:"15日",DATE_20_FOLLOWING_MONTH:"20日"},o={END_NEXT_MONTH:"翌月末",DATE_25_NEXT_MONTH:"翌月25日",DATE_20_NEXT_MONTH:"翌月20日",DATE_15_NEXT_MONTH:"翌月15日",DATE_10_NEXT_MONTH:"翌月10日",DATE_5_SECOND_MONTH:"翌々月5日",DATE_10_SECOND_MONTH:"翌々月10日"},d=e=>{let t=e.split("-");return"".concat(parseInt(t[0]),"年").concat(parseInt(t[1]),"月").concat(parseInt(t[2]),"日")},u=(e,t,i)=>{t=parseInt(t),e.scrollTop+e.clientHeight>=e.scrollHeight-t&&i()},c=e=>{let t=null==e?void 0:e.map(e=>({id:e.customerFacility.id,name:e.customerFacility.name})),i=new Map;null==t||t.forEach(e=>{i.has(e.name)||i.set(e.name,e)});let l=Array.from(i.values());return l.sort((e,t)=>e.name.localeCompare(t.name,"ja"))};var m=new Date;let p=new Date(m.getFullYear(),m.getMonth(),1),h=new Date(m.getFullYear(),m.getMonth()+1,0),v=e=>{let t=new Date(e);return t.setMonth(t.getMonth()+1),t.setDate(0),t},x=e=>e?n()(e).format("YYYY-MM-DD"):null,f=e=>{let t=Intl.NumberFormat("en-US"),i=t.format(Math.floor(parseInt(e)));return i}},81820:function(e,t,i){"use strict";var l=i(10987);let n=(0,l.rh)({todos:{list:e=>[e],detail:e=>[e]},adminBulletins:{list:e=>[e],detail:e=>[e]},adminPrefectures:{list:e=>[e],detail:e=>[e]},adminItems:{list:e=>[e],export:e=>[e],detail:e=>[e]},adminCourses:{list:e=>[e],detail:e=>[e]},adminSuppliers:{list:e=>[e],detail:e=>[e],holiday:e=>[e]},adminAllergens:{list:e=>[e],detail:e=>[e]},adminItemPacks:{list:e=>[e],export:e=>[e],detail:e=>[e]},adminItemPacksInventories:{list:e=>[e]},adminItemPackLogs:{list:e=>[e]},adminMenus:{list:e=>[e],detail:e=>[e]},adminTimeSections:{list:e=>[e],detail:e=>[e]},adminCustomers:{list:e=>[e],export:e=>[e],detail:e=>[e]},adminSupplierPurchases:{list:e=>[e],export:e=>[e],detail:e=>[e]},adminSupplierPurchaseMonthlies:{list:e=>[e],detail:e=>[e]},adminCustomersFacilities:{list:e=>[e],detail:e=>[e]},facilityKinds:{list:e=>[e],detail:e=>[e]},adminWarehouses:{list:e=>[e],detail:e=>[e]},adminSupplierInvoiceMonthlies:{list:e=>[e],export:e=>[e],detail:e=>[e]},adminCustomerInvoiceMonthlies:{list:e=>[e],export:e=>[e],detail:e=>[e]},adminCustomerPurchaseMenus:{list:e=>[e],detail:e=>[e]},adminCustomerPurchaseSingles:{list:e=>[e],detail:e=>[e]},adminCustomerPurchaseMousses:{list:e=>[e],detail:e=>[e]},adminCustomerPurchaseRices:{list:e=>[e],detail:e=>[e]},adminServes:{list:e=>[e],detail:e=>[e]},adminCustomerPurchaseMonthlies:{list:e=>[e],detail:e=>[e]},adminItemDeliveries:{list:e=>[e]},adminCustomerDeliveries:{list:e=>[e],deliver:e=>[e],exportDeliverySlip:e=>[e]},adminCustomerDeliveriesGenerate:{list:e=>[e],detail:e=>[e]},adminCustomerDeliveriesExportDeliverySlip:{list:e=>[e]},adminCustomerDeliveriesDeliver:{list:e=>[e]},publicTemperature:{list:e=>[e]},publicClosingType:{list:e=>[e]},publicPaymentType:{list:e=>[e]},publicTimezoneType:{list:e=>[e]},publicDeliveryFrequency:{list:e=>[e]}});t.Z=n},70152:function(e,t,i){"use strict";i.d(t,{D1:function(){return x},vM:function(){return Z},i6:function(){return h},eu:function(){return v},Fx:function(){return p},cN:function(){return f}});var l=i(59403),n=i(36492),r=i(48228),s=i(29180);let a=e=>s.Z.get("admin/prefectures",{params:e}),o=(e,t)=>s.Z.get("admin/prefectures/".concat(e),{params:t}),d=e=>s.Z.delete("admin/prefectures/".concat(e)),u=e=>s.Z.post("admin/prefectures",e),c=(e,t)=>s.Z.put("admin/prefectures/".concat(e),t);var m=i(81820);let p=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=m.Z.adminSuppliers.list(e).queryKey,n=t=>a({...e,page:t});return(0,l.N)({queryKey:i,queryFn:e=>{let{pageParam:t}=e;return n(t)},getNextPageParam:e=>{var t,i;if(null==e?void 0:null===(t=e.data)||void 0===t?void 0:t.last)return null;let l=(null==e?void 0:null===(i=e.data)||void 0===i?void 0:i.number)+1;return l+1},...t})},h=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=m.Z.adminPrefectures.list(e).queryKey,l=()=>a(e),r={...t};return(0,n.a)({queryKey:i,queryFn:l,...r})},v=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=m.Z.adminPrefectures.detail(e).queryKey,l=()=>o(e),r={...t};return(0,n.a)({queryKey:i,queryFn:l,...r})},x=()=>(0,r.D)(e=>d(e)),f=()=>(0,r.D)(e=>u(e)),Z=e=>(0,r.D)(t=>c(e,t))},29739:function(e,t,i){"use strict";i.d(t,{P:function(){return d},L:function(){return o}});var l=i(36492),n=i(29180);let r=e=>n.Z.get("admin/supplier-invoice-monthlies",{params:e}),s=e=>n.Z.get("admin/supplier-invoice-monthlies/export",{params:e,responseType:"blob"});var a=i(81820);let o=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=a.Z.adminSupplierInvoiceMonthlies.list(e).queryKey,n=()=>r(e);return(0,l.a)({queryKey:i,queryFn:n,...t})},d=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=a.Z.adminSupplierInvoiceMonthlies.export(e).queryKey,n=()=>s(e),r={...t};return(0,l.a)({queryKey:i,queryFn:n,...r})}},69531:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return G}});var l=i(85893),n=i(67294),r=i(35823),s=i.n(r),a=i(9198),o=i.n(a),d=i(35937),u=i.n(d),c=i(86874),m=i(74368),p=i(66476),h=i(69417),v=i(86886);let x=(0,n.forwardRef)((e,t)=>(0,l.jsx)(p.Z,{...e,inputRef:t,label:null==e?void 0:e.label,autoComplete:"off"}));x.displayName="CustomDateInput";let f=e=>{let{setFilterApplied:t}=e,[i,r]=(0,n.useState)({issueAtPeriodFrom:m.cB,issueAtPeriodTo:m.Kd,supplierName:"",supplierPointName:""}),s=e=>t=>{var l,n;let s=null!==(n=null==t?void 0:null===(l=t.target)||void 0===l?void 0:l.value)&&void 0!==n?n:t;"issueAtPeriodTo"==e&&(s=(0,m.$U)(s)),r({...i,[e]:s})},a=()=>{let e=(0,m.ec)(null==i?void 0:i.issueAtPeriodFrom),l=(0,m.ec)(null==i?void 0:i.issueAtPeriodTo),n=u()({...i,issueAtPeriodFrom:e,issueAtPeriodTo:l},e=>!!e)||{};t(n)};return(0,l.jsxs)(v.ZP,{container:!0,spacing:5,p:"24px",children:[(0,l.jsxs)(v.ZP,{item:!0,container:!0,spacing:5,alignItems:"flex-end",children:[(0,l.jsx)(v.ZP,{item:!0,lg:5.825,md:5.825,xs:12,children:(0,l.jsx)(c.Z,{children:(0,l.jsx)(o(),{id:"issueAtPeriodFrom",selected:null==i?void 0:i.issueAtPeriodFrom,showMonthYearPicker:!0,dateFormat:"yyyy/MM",placeholderText:"YYYY/MM",onChange:s("issueAtPeriodFrom"),customInput:(0,l.jsx)(x,{fullWidth:!0,label:"請求月"})})})}),(0,l.jsx)(v.ZP,{item:!0,xs:.35,lg:.35,md:.35,marginBottom:1,display:{xs:"none",lg:"block",md:"block"},children:"〜"}),(0,l.jsx)(v.ZP,{item:!0,lg:5.825,md:5.825,xs:12,children:(0,l.jsx)(c.Z,{children:(0,l.jsx)(o(),{id:"issueAtPeriodTo",selected:null==i?void 0:i.issueAtPeriodTo,showMonthYearPicker:!0,dateFormat:"yyyy/MM",placeholderText:"YYYY/MM",onChange:s("issueAtPeriodTo"),customInput:(0,l.jsx)(x,{fullWidth:!0})})})})]}),(0,l.jsxs)(v.ZP,{item:!0,container:!0,spacing:5,alignItems:"flex-end",children:[(0,l.jsx)(v.ZP,{item:!0,lg:5.825,md:5.825,xs:12,children:(0,l.jsx)(p.Z,{fullWidth:!0,type:"text",label:"仕入先顧客名",value:null==i?void 0:i.supplierName,id:"supplierName",onChange:s("supplierName")})}),(0,l.jsx)(v.ZP,{item:!0,xs:.35,lg:.35,md:.35,marginBottom:1,display:{xs:"none",lg:"block",md:"block"}}),(0,l.jsx)(v.ZP,{item:!0,lg:5.825,md:5.825,xs:12,children:(0,l.jsx)(p.Z,{fullWidth:!0,type:"text",label:"仕入先請求先名",value:null==i?void 0:i.supplierPointName,id:"supplierPointName",onChange:s("supplierPointName")})}),(0,l.jsx)(v.ZP,{item:!0,container:!0,xs:12,justifyContent:"center",children:(0,l.jsx)(v.ZP,{xs:2,children:(0,l.jsx)(h.Z,{fullWidth:!0,color:"warning",variant:"contained",onClick:a,children:"検索"})})})]})]})};var Z=i(85945);i(27484);var P=i(96486),j=i(81820),y=i(70152),g=i(29739),T=i(48228),N=i(29180);let b=e=>N.Z.post("admin/supplier-payments",e),_=(e,t)=>N.Z.put("admin/supplier-payments/".concat(e),t),S=()=>(0,T.D)(e=>{let{body:t}=e;return b(t)}),D=()=>(0,T.D)(e=>{let{id:t,body:i}=e;return _(t,i)});var C=i(36822),w=i(90629),M=i(7906),A=i(295),E=i(53252),I=i(72882),F=i(53184),k=i(53816),O=i(26280),L=i(13113),Y=i(92832),W=i(53198),H=[{id:"name",label:"企業名",withSort:!0},{id:"name",label:"請求先名",withSort:!0},{id:"name",label:"請求月",withSort:!0},{id:"name",label:"前月繰越",withSort:!0},{id:"name",label:"当月仕入",withSort:!0},{id:"name",label:"当月請求",withSort:!0},{id:"name",label:"当月支払い",withSort:!0},{id:"name",label:"次月繰越",withSort:!0}];let R=e=>{let{filterApplied:t}=e,i=(0,Z.NL)(),[r,s]=(0,n.useState)(0),[a,o]=(0,n.useState)(10),[d,u]=(0,n.useState)("desc"),[c,m]=(0,n.useState)("createdAt"),[p,v]=(0,n.useState)(null),[x,f]=(0,n.useState)(null),[P,y]=(0,n.useState)(!1),{mutateAsync:T}=S(),{mutateAsync:N}=D(),b=e=>{u(c===e&&"asc"===d?"desc":"asc"),m(e)},_=async()=>{let e=null==x?void 0:x.filter((e,t)=>{var i;return parseFloat((null==e?void 0:e.totalPayed)||0)!==(null==p?void 0:null===(i=p[t])||void 0===i?void 0:i.totalPayed)});(null==e?void 0:e.length)<=0||(null==e||e.map(async e=>{var t,i,l;let n=null==e?void 0:null===(t=e.supplierPayment)||void 0===t?void 0:t.id,r=parseFloat((null==e?void 0:e.totalPayed)||0);if(y(!0),n)await N({id:n,body:{totalPayed:r}});else{let t={supplier:{id:null==e?void 0:null===(i=e.supplier)||void 0===i?void 0:i.id},supplierPoint:{id:null==e?void 0:null===(l=e.supplierPoint)||void 0===l?void 0:l.id},issueAtPeriod:null==e?void 0:e.issueAtPeriod,totalPayed:r};await T({body:t}),y(!1)}}),await Promise.all(e),i.refetchQueries(j.Z.adminSupplierInvoiceMonthlies.key))},{isFetching:Y}=(0,g.L)(t,{onSuccess:e=>{var t;let i=null==e?void 0:null===(t=e.data)||void 0===t?void 0:t.content;v(i),f(i)}});return(0,l.jsxs)(w.Z,{sx:{width:"100%",overflow:"hidden"},children:[(0,l.jsx)(I.Z,{children:(0,l.jsxs)(M.Z,{stickyHeader:!0,"aria-label":"sticky table",children:[(0,l.jsx)(F.Z,{children:(0,l.jsx)(k.Z,{children:H.map(e=>(0,l.jsx)(E.Z,{align:e.align,style:{width:null==e?void 0:e.width},children:(null==e?void 0:e.withSort)?(0,l.jsxs)(O.Z,{active:c===e.id,direction:c===e.id?d:"asc",onClick:()=>b(e.id),children:[e.label,c===e.id?(0,l.jsx)(C.Z,{component:"span",sx:L.Z,children:"desc"===d?"sorted descending":"sorted ascending"}):null]}):e.label},e.id))})}),(0,l.jsx)(A.Z,{children:Y?(0,l.jsx)(W.Z,{rowsNum:10,cellsNum:8}):(null==x?void 0:x.length)==0?(0,l.jsx)(k.Z,{children:(0,l.jsx)(E.Z,{colSpan:null==H?void 0:H.length,align:"center",children:"「該当する品目はありません。」"})}):null==x?void 0:x.map((e,t)=>(0,l.jsx)(B,{index:t,row:e,listEditedPayments:x,setListEditedPayments:f},e.id))})]})}),(0,l.jsx)(C.Z,{sx:{display:"flex",justifyContent:"flex-end",margin:"24px"},children:(0,l.jsx)(h.Z,{variant:"contained",onClick:_,disabled:P,children:"保存"})})]})},B=e=>{var t,i;let{row:r,index:s,listEditedPayments:a,setListEditedPayments:o}=e,d=(0,Z.NL)(),[u,c]=(0,n.useState)(!1),{mutate:h}=(0,y.D1)(),v=(null==r?void 0:r.totalInvoiced)-parseFloat((null==r?void 0:r.totalPayed)||0),x=()=>{h(null==r?void 0:r.id,{onSuccess:()=>{c(!1),d.refetchQueries(j.Z.adminPrefectures._def)}})},f=e=>{let t=(0,P.cloneDeep)(a);t[s].totalPayed=e,o(t)};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(k.Z,{hover:!0,children:[(0,l.jsx)(E.Z,{children:null==r?void 0:null===(t=r.supplier)||void 0===t?void 0:t.name}),(0,l.jsx)(E.Z,{children:null==r?void 0:null===(i=r.supplierPoint)||void 0===i?void 0:i.name}),(0,l.jsx)(E.Z,{children:null==r?void 0:r.issueAtPeriod}),(0,l.jsx)(E.Z,{children:(0,m.hN)(null==r?void 0:r.totalRestAccumulative)}),(0,l.jsx)(E.Z,{children:(0,m.hN)(null==r?void 0:r.totalInvoiced)}),(0,l.jsx)(E.Z,{children:(0,m.hN)(null==r?void 0:r.totalRestResult)}),(0,l.jsx)(E.Z,{children:(0,l.jsx)(p.Z,{fullWidth:!0,type:"number",value:null==r?void 0:r.totalPayed,onChange:e=>f(e.target.value)})}),(0,l.jsx)(E.Z,{children:(0,m.hN)(v)})]}),(0,l.jsx)(Y.Z,{show:u,setShow:c,onClickSubmit:x,title:"都道府県",description:"本当によろしいでしょうか？"})]})};var K=i(66242),q=i(44267),X=i(78445);let U=()=>{let[e,t]=(0,n.useState)({issueAtPeriodFrom:(0,m.ec)(m.cB),issueAtPeriodTo:(0,m.ec)(m.Kd)}),{refetch:i}=(0,g.P)(e,{enabled:!1,onSuccess:e=>{(null==e?void 0:e.data)&&s()(null==e?void 0:e.data,"仕入・支払管理.csv")}});return(0,l.jsx)(v.ZP,{container:!0,spacing:6,children:(0,l.jsx)(v.ZP,{item:!0,xs:12,children:(0,l.jsxs)(K.Z,{children:[(0,l.jsx)(X.Z,{title:"仕入/支払管理",action:(0,l.jsx)(h.Z,{variant:"contained",color:"info",onClick:i,children:"CSV ダウンロード"})}),(0,l.jsxs)(q.Z,{sx:{p:0,"&:last-child":{pb:0}},children:[(0,l.jsx)(f,{setFilterApplied:t}),(0,l.jsx)(R,{filterApplied:e})]})]})})})};var G=U}},function(e){e.O(0,[3662,8360,7851,8271,2288,6682,6261,7064,3863,7206,5643,2584,1770,7727,9774,2888,179],function(){return e(e.s=91001)}),_N_E=e.O()}]);